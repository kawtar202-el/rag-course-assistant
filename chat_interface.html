<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG Course Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5c2e7 0%, #ffffff 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            padding: 20px 0;
            color: #88304e;
            margin-bottom: 20px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-weight: 600;
        }

        header p {
            font-size: 1.1em;
            opacity: 0.8;
        }

        .chat-container {
            flex: 1;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(245, 194, 231, 0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 60vh;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 80%;
            padding: 16px 22px;
            border-radius: 22px;
            margin-bottom: 12px;
            position: relative;
            animation: fadeIn 0.3s ease-out;
            line-height: 1.5;
            font-size: 16px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            background: #d73a70;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .model-message {
            background: #fff0f5;
            color: #88304e;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .input-container {
            display: flex;
            padding: 20px;
            background: white;
            border-top: 1px solid #f8e6ec;
        }

        .input-container input {
            flex: 1;
            padding: 14px 20px;
            border: 2px solid #f5c2e7;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .input-container input:focus {
            border-color: #d73a70;
            box-shadow: 0 0 0 3px rgba(245, 194, 231, 0.4);
        }

        .input-container button {
            margin-left: 10px;
            padding: 14px 28px;
            background: #d73a70;
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s, transform 0.2s;
        }

        .input-container button:hover {
            background: #b91c5c;
            transform: translateY(-2px);
        }

        .input-container button:disabled {
            background: #f5c2e7;
            cursor: not-allowed;
            transform: none;
        }

        .typing-indicator {
            display: none;
            padding: 14px 20px;
            background: #fff0f5;
            color: #d73a70;
            border-radius: 20px;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            margin-bottom: 10px;
            font-style: italic;
        }

        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #d73a70;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .info-box {
            background: #fdf2f8;
            border-left: 4px solid #f472b6;
            padding: 15px;
            margin: 10px 20px 0;
            border-radius: 0 8px 8px 0;
            font-size: 0.9em;
            color: #88304e;
        }

        .examples-container {
            background: #fdf2f8;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 20px 0;
        }

        .examples-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #d73a70;
        }

        .example-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .example-btn {
            display: inline-block;
            padding: 8px 15px;
            background: #f472b6;
            color: white;
            border-radius: 18px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s, transform 0.2s;
        }

        .example-btn:hover {
            background: #d73a70;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            header h1 {
                font-size: 2em;
            }

            .message {
                max-width: 90%;
            }

            .chat-messages {
                max-height: 50vh;
            }

            .input-container input {
                padding: 12px 16px;
            }

            .input-container button {
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>RAG Course Assistant</h1>
            <p>Ask questions about your course materials</p>
        </header>

        <div class="chat-container">
            <div class="info-box">
                This interface connects to your RAG system. The AI uses your course materials to answer questions.
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message model-message">
                    Welcome! I'm your RAG Course Assistant. I can answer questions about your course materials including machine learning, recommender systems, and text mining. What would you like to know?
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <div class="input-container">
                <input type="text" id="userInput" placeholder="Type your question about course materials..." autocomplete="off">
                <button id="sendButton" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chatMessages');
        const userInput = document.getElementById('userInput');
        const sendButton = document.getElementById('sendButton');
        const typingIndicator = document.getElementById('typingIndicator');

        // Array of example questions to help users
        const exampleQuestions = [
            "What is machine learning?",
            "Explain recommender systems",
            "How does collaborative filtering work?",
            "What is text mining?",
            "Tell me about topic modeling",
            "What are the types of machine learning?",
            "Explain neural networks",
            "What is supervised learning?"
        ];

        // Add example questions as clickable suggestions
        function addExampleQuestions() {
            const examplesContainer = document.createElement('div');
            examplesContainer.className = 'examples-container';
            
            const title = document.createElement('div');
            title.className = 'examples-title';
            title.textContent = 'Try asking:';
            
            const buttonsContainer = document.createElement('div');
            buttonsContainer.className = 'example-buttons';
            
            exampleQuestions.forEach(question => {
                const btn = document.createElement('span');
                btn.className = 'example-btn';
                btn.textContent = question;
                btn.onclick = () => fillQuestion(question);
                buttonsContainer.appendChild(btn);
            });
            
            examplesContainer.appendChild(title);
            examplesContainer.appendChild(buttonsContainer);
            chatMessages.appendChild(examplesContainer);
            scrollToBottom();
        }

        // Fill question in the input field
        function fillQuestion(question) {
            userInput.value = question;
            userInput.focus();
        }

        // Add message to chat
        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'model-message'}`;
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        // Show typing indicator
        function showTypingIndicator() {
            typingIndicator.style.display = 'block';
            scrollToBottom();
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        // Scroll to bottom of chat
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Send message to backend API
        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;

            // Add user message
            addMessage(message, true);
            userInput.value = '';
            sendButton.disabled = true;

            // Show typing indicator
            showTypingIndicator();

            try {
                // Call the backend API
                const response = await fetch('http://localhost:8000/ask', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ question: message })
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();

                // Hide typing indicator
                hideTypingIndicator();

                // Add model response
                addMessage(data.answer, false);

            } catch (error) {
                console.error('Error:', error);
                hideTypingIndicator();
                addMessage("Sorry, I encountered an error processing your question. Please try again.", false);
            } finally {
                sendButton.disabled = false;
            }
        }

        // Allow sending message with Enter key
        userInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Add example questions when page loads
        window.onload = function() {
            setTimeout(addExampleQuestions, 500);
        };
    </script>
</body>
</html>